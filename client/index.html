<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Lovechat Call</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./styles.css" />
  <link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#0b1220">

</head>
<body>
  <div class="call-container" id="callContainer">
    <!-- Remote full-screen video -->
    <video id="remoteVideo" class="remote" autoplay playsinline></video>

    <!-- Draggable local preview -->
    <div id="localWrapper" class="local-wrapper" tabindex="0" aria-label="Local preview">
      <video id="localVideo" class="local" autoplay playsinline muted></video>
    </div>

    <!-- Top bar: room + status -->
    <div class="topbar" id="topbar">
      <div class="left">
        <input id="roomId" class="room-input" placeholder="Room ID (e.g., couple-123)" />
        <span id="status" class="status-dot">idle</span>
      </div>
      <div class="right">
        <button id="joinBtn" class="chip">Join</button>
        <button id="leaveBtn" class="chip" disabled>Leave</button>
        <label class="chip small"><input type="checkbox" id="voiceOnly" /> Voice-only</label>
      </div>
    </div>

    <!-- Bottom controls (auto-hide) -->
    <div class="controls hidden" id="controls" aria-hidden="true">
      <button class="fab danger" id="endCall" title="End Call" data-action="end">
        <!-- phone hangup -->
        <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M6.54 5.64a15.91 15.91 0 0 1 10.92 0l.74.3a2 2 0 0 1 1.2 2.58l-.84 2.1a2 2 0 0 1-2.54 1.15l-1.46-.54a10.61 10.61 0 0 0-4.04-.56c-1.35.05-2.69.26-4.01.62l-1.37.39a2 2 0 0 1-2.44-1.21L2.2 8.5a2 2 0 0 1 1.2-2.58l.74-.3z"/></svg>
      </button>

      <div class="pill">
        <button id="toggleMic" class="icon" disabled title="Mute/Unmute">
          <!-- mic -->
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M12 14a3 3 0 0 0 3-3V6a3 3 0 1 0-6 0v5a3 3 0 0 0 3 3zm5-3a5 5 0 0 1-10 0H5a7 7 0 0 0 6 6.92V21h2v-3.08A7 7 0 0 0 19 11h-2z"/></svg>
        </button>
        <button id="toggleCam" class="icon" disabled title="Camera On/Off">
          <!-- video -->
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M17 10.5V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3.5l4 4v-11l-4 4z"/></svg>
        </button>
        <button id="switchCam" class="icon" disabled title="Switch Camera">
          <!-- camera-switch -->
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M7 7h1.17L9.59 5h4.82l1.41 2H17a3 3 0 0 1 3 3v1h-2V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v1H4V10a3 3 0 0 1 3-3zm10 10h-1.17L14.41 19H9.59l-1.41-2H7a3 3 0 0 1-3-3v-1h2v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-1h2v1a3 3 0 0 1-3 3z"/></svg>
        </button>
        <button id="shareScreen" class="icon" disabled title="Share Screen">
          <!-- screen-share -->
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M20 3H4a2 2 0 0 0-2 2v9h2V5h16v9h2V5a2 2 0 0 0-2-2zM2 19h20v-2H2v2zm11-6h3l-4-4-4 4h3v4h2v-4z"/></svg>
        </button>
        <button id="pipBtn" class="icon" title="Pop-out (PiP)">
          <!-- picture-in-picture -->
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v6h-2V5H5v14h14v-4h2v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm9 4h7v5h-7V9z"/></svg>
        </button>
      </div>
    </div>

    <!-- Tap-catcher for toggling controls -->
    <button id="touchLayer" class="touch-layer" aria-label="Toggle controls"></button>

    <!-- Debug log (collapsible) -->
    <details class="debug">
      <summary>Logs</summary>
      <pre id="log"></pre>
    </details>
  </div>

  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script type="module" src="./app.js"></script>
  <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js');
}
</script>

</body>
</html>
